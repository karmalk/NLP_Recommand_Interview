# 操作系统

---



[TOC]

## 1. 进程与线程

### 1. 进程与线程的区别

**进程**是具有一定独立功能的关于某个数据集合上的一个**运行活动**，进程是系统进行资源分配和调度的一个**独立单位**。

**线程**是进程的一个**实体**，是CPU调度和分派的基本单位，它是比进程更小的能独立运行的基本单位，线程自己基本上不拥有系统资源，只拥有一点在运行中必不可少的资源，但是它可与同属于一个线程的其他线程共享进程所有的全部资源。

**一个程序至少有一个进程，一个进程至少有一个线程**，线程的划分尺度小于进程，使得多线程程序的并发性高，进程在执行过程中拥有独立的内存单元，而多个线程共享内存，从而极大的提高了程序的运行效率。

**执行过程**：线程和进程在执行过程中有所区别，每个独立的线程有一个**程序运行的入口**，**顺序执行序列**和**程序的出口**，但是线程不能够独立执行，必须依存在应用程序中，有应用程序来提供多个线程执行控制。

**逻辑角度**：多线程的意义在于一个应用程序中，多个执行部分可以同时执行，但操作系统中并没有将多个线程看做多个独立的应用来实现进程的调度和管理以及资源分配。

### 2. 进程间通信的方式

- **匿名管道通信**：管道是一种半双工的通信方式，数据只能单向流动，而且只能在具有亲缘关系(**父子进程**)的进程间使用，
- **高级管道通信**：
- **有名管道通信**：也是半双工通信，但是它允许无亲缘关系进程间的通信.
- **消息队列通信**：消息队列是由消息的链表，存放在内核中并由消息队列标识符标识。消息队列克服了信号传递信息少、管道只能承载无格式字节流以及缓冲区大小受限等缺点。
- **信号量通信**：信号是一种比较复杂的通信方式，用于通知接收进程某个事件已经发生。
- **共享内存通信**：共享内存就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问。共享内存是最快的 IPC 方式，它是针对其他进程间通信方式运行效率低而专门设计的。它往往与其他通信机制，如信号两，配合使用，来实现进程间的同步和通信。
- **套接字通信**：套解口也是一种进程间通信机制，与其他通信机制不同的是，它可用于不同及其间的进程通信。

### 3. 线程间的通信方式

- **锁机制**：包括互斥锁，条件变量，读写锁
  - 互斥锁提供了以排他方式防止数据结构被并发修改的方法。
  - 读写锁允许多个线程同时读共享数据，而对写操作是互斥的
  - 条件变量可以以原子的方式阻塞进程，直到某个特定条件为真位置，对条件的测试是在互斥锁的保护下进行的，条件变量始终于互斥锁一起使用
- **信号量机制**：包括无名线程信号量和命名线程信号量。
- **信号机制**：类似进程间的信号处理。



### 4. 简单介绍下死锁，为什么会产生死锁以及产生死锁的条件

由于系统中存在一些不可剥夺资源，而当两个或者两个以上的进程占有自身资源，并请求对方资源时，会导致每个进程都无法向前推进，便形成死锁。

四个必要条件：

- **互斥条件：**进程要求分配的资源时排他性的，即最多只能同时给一个进程使用。
- **不可剥夺条件：**指进程在使用资源完毕之前，资源不能被强行夺走。
- **请求保持条件：**指进程占有自身本来拥有的资源并要求其他资源。
- **循环等待条件：**指存在一种进程资源的循环等待链

解决办法：

- **预防死锁：**通过设定一些限制条件，破坏死锁的一些必要条件，让死锁无法发生
- **死锁避免：**在动态分配资源过程中，用一些算法防止系统进入不安全状态
- **死锁的检测和解除：**在死锁前不采取任何措施，只检测当前系统有没有发生死锁，并采取一些措施解除死锁。

